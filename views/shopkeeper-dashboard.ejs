<%- include('partials/header') %>

<div style="max-width:1100px;margin:30px auto">
  <div style="display:flex;gap:20px;align-items:flex-start">
    <div style="flex:1">
      <h2 style="color:#1b4f72">Welcome, <%= shop.shopName || shop.name %></h2>

      <div style="background:white;padding:16px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08)">
        <h3>Add Product</h3>
        <form action="/shop/product/add" method="POST" enctype="multipart/form-data">
          <input name="name" placeholder="Product name" required style="width:100%;padding:8px;margin:8px 0">
          <input name="price" type="number" placeholder="Price" required style="width:100%;padding:8px;margin:8px 0">
          <input name="qty" type="number" placeholder="Quantity" required style="width:100%;padding:8px;margin:8px 0">
          <textarea name="description" placeholder="Description" style="width:100%;padding:8px;margin:8px 0"></textarea>
          <input name="image" type="file" accept="image/*" style="margin:8px 0">
          <button style="padding:10px 12px;background:#1b4f72;color:white;border:none;border-radius:8px">Add Product</button>
        </form>
      </div>

      <h3 style="margin-top:20px">Your Products</h3>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px">
        <% products.forEach(p => { %>
          <div style="background:white;padding:12px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.06)">
            <img src="<%= p.image || '/public/product-placeholder.png' %>" style="width:100%;height:150px;object-fit:cover;border-radius:8px">
            <h4 style="color:#1b4f72;margin:8px 0"><%= p.name %></h4>
            <p>₹<%= p.price %> • Qty: <%= p.qty %></p>

            <form action="/shop/product/<%= p._id %>?_method=PUT" method="POST" enctype="multipart/form-data" style="margin-top:8px">
              <input name="name" value="<%= p.name %>" style="width:100%;padding:6px;margin:6px 0">
              <input name="price" value="<%= p.price %>" style="width:100%;padding:6px;margin:6px 0">
              <input name="qty" value="<%= p.qty %>" style="width:100%;padding:6px;margin:6px 0">
              <input name="image" type="file">
              <button style="padding:8px 10px;background:#f0ad4e;border:none;color:white;border-radius:8px">Save</button>
            </form>

            <form action="/shop/product/<%= p._id %>?_method=DELETE" method="POST" style="margin-top:8px">
              <button style="padding:8px 10px;background:#d9534f;border:none;color:white;border-radius:8px">Delete</button>
            </form>
          </div>
        <% }) %>
      </div>
    </div>

    <div style="width:380px">
      <h3>Orders</h3>
      <% orders.forEach(o => { %>
        <div style="background:white;padding:12px;margin-bottom:12px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.06)">
          <h4>Order #<%= o._id %></h4>
          <p>From: <%= o.customer?.name %></p>
          <ul>
            <% o.items.forEach(it => { %>
              <li><%= it.qty %> x <%= it.product %> (₹<%= it.price %>)</li>
            <% }) %>
          </ul>
          <p>Total: ₹<%= o.total %></p>
          <form action="/shop/order/<%= o._id %>/status" method="POST">
            <select name="status">
              <option value="pending" <%= o.status==='pending'?'selected':'' %>>Pending</option>
              <option value="accepted" <%= o.status==='accepted'?'selected':'' %>>Accepted</option>
              <option value="shipped" <%= o.status==='shipped'?'selected':'' %>>Shipped</option>
              <option value="delivered" <%= o.status==='delivered'?'selected':'' %>>Delivered</option>
              <option value="rejected" <%= o.status==='rejected'?'selected':'' %>>Rejected</option>
            </select>
            <button style="padding:8px 10px;background:#1b4f72;color:white;border:none;border-radius:6px;margin-left:8px">Update</button>
          </form>
        </div>
      <% }) %>
    </div>
  </div>
</div>

<%- include('partials/footer') %>
